{"numFailedTestSuites":1,"numFailedTests":5,"numPassedTestSuites":0,"numPassedTests":0,"numPendingTestSuites":0,"numPendingTests":0,"numRuntimeErrorTestSuites":0,"numTodoTests":0,"numTotalTestSuites":1,"numTotalTests":5,"openHandles":[],"snapshot":{"added":0,"didUpdate":false,"failure":false,"filesAdded":0,"filesRemoved":0,"filesRemovedList":[],"filesUnmatched":0,"filesUpdated":0,"matched":0,"total":0,"unchecked":0,"uncheckedKeysByFile":[],"unmatched":0,"updated":0},"startTime":1743455425014,"success":false,"testResults":[{"assertionResults":[{"ancestorTitles":["Authentication Middleware","withAuthentication"],"duration":4,"failureDetails":[{"matcherResult":{"message":"expect(jest.fn()).toHaveBeenCalledWith(...expected)\n\nExpected: ObjectContaining {\"error\": \"Unauthorized\"}, ObjectContaining {\"status\": 401}\nReceived: {\"success\": true}\n\nNumber of calls: 1","pass":false}}],"failureMessages":["Error: expect(jest.fn()).toHaveBeenCalledWith(...expected)\n\nExpected: ObjectContaining {\"error\": \"Unauthorized\"}, ObjectContaining {\"status\": 401}\nReceived: {\"success\": true}\n\nNumber of calls: 1\n    at Object.toHaveBeenCalledWith (C:\\Users\\T\\directorymonster\\tests\\unit\\middleware\\mytest.test.ts:41:36)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)"],"fullName":"Authentication Middleware withAuthentication should reject requests without authentication","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"should reject requests without authentication"},{"ancestorTitles":["Authentication Middleware","withAuthentication"],"duration":1,"failureDetails":[{"matcherResult":{"message":"expect(jest.fn()).toHaveBeenCalledWith(...expected)\n\nExpected: ObjectContaining {\"error\": \"Unauthorized\"}, ObjectContaining {\"status\": 401}\nReceived: {\"success\": true}\n\nNumber of calls: 1","pass":false}}],"failureMessages":["Error: expect(jest.fn()).toHaveBeenCalledWith(...expected)\n\nExpected: ObjectContaining {\"error\": \"Unauthorized\"}, ObjectContaining {\"status\": 401}\nReceived: {\"success\": true}\n\nNumber of calls: 1\n    at Object.toHaveBeenCalledWith (C:\\Users\\T\\directorymonster\\tests\\unit\\middleware\\mytest.test.ts:60:36)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)"],"fullName":"Authentication Middleware withAuthentication should reject requests with invalid token format","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"should reject requests with invalid token format"},{"ancestorTitles":["Authentication Middleware","withAuthentication"],"duration":1,"failureDetails":[{"matcherResult":{"message":"expect(jest.fn()).toHaveBeenCalled()\n\nExpected number of calls: >= 1\nReceived number of calls:    0","pass":false}}],"failureMessages":["Error: expect(jest.fn()).toHaveBeenCalled()\n\nExpected number of calls: >= 1\nReceived number of calls:    0\n    at Object.toHaveBeenCalled (C:\\Users\\T\\directorymonster\\tests\\unit\\middleware\\mytest.test.ts:79:22)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)"],"fullName":"Authentication Middleware withAuthentication should reject requests with invalid token","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"should reject requests with invalid token"},{"ancestorTitles":["Authentication Middleware","withAuthentication"],"duration":1,"failureDetails":[{"matcherResult":{"message":"expect(jest.fn()).toHaveBeenCalled()\n\nExpected number of calls: >= 1\nReceived number of calls:    0","pass":false}}],"failureMessages":["Error: expect(jest.fn()).toHaveBeenCalled()\n\nExpected number of calls: >= 1\nReceived number of calls:    0\n    at Object.toHaveBeenCalled (C:\\Users\\T\\directorymonster\\tests\\unit\\middleware\\mytest.test.ts:99:22)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)"],"fullName":"Authentication Middleware withAuthentication should allow requests with valid token","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"should allow requests with valid token"},{"ancestorTitles":["Authentication Middleware","withAuthentication"],"duration":1,"failureDetails":[{"matcherResult":{"message":"expect(jest.fn()).toHaveBeenCalled()\n\nExpected number of calls: >= 1\nReceived number of calls:    0","pass":false}}],"failureMessages":["Error: expect(jest.fn()).toHaveBeenCalled()\n\nExpected number of calls: >= 1\nReceived number of calls:    0\n    at Object.toHaveBeenCalled (C:\\Users\\T\\directorymonster\\tests\\unit\\middleware\\mytest.test.ts:123:22)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)"],"fullName":"Authentication Middleware withAuthentication should handle unexpected errors in the handler","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"should handle unexpected errors in the handler"}],"endTime":1743455425909,"message":"  ● Authentication Middleware › withAuthentication › should reject requests without authentication\n\n    expect(jest.fn()).toHaveBeenCalledWith(...expected)\n\n    Expected: ObjectContaining {\"error\": \"Unauthorized\"}, ObjectContaining {\"status\": 401}\n    Received: {\"success\": true}\n\n    Number of calls: 1\n\n    \u001b[0m \u001b[90m 39 |\u001b[39m       \u001b[36mawait\u001b[39m withAuthentication(req\u001b[33m,\u001b[39m handler)\u001b[33m;\u001b[39m\n     \u001b[90m 40 |\u001b[39m\n    \u001b[31m\u001b[1m>\u001b[22m\u001b[39m\u001b[90m 41 |\u001b[39m       expect(mockNextResponseJson)\u001b[33m.\u001b[39mtoHaveBeenCalledWith(\n     \u001b[90m    |\u001b[39m                                    \u001b[31m\u001b[1m^\u001b[22m\u001b[39m\n     \u001b[90m 42 |\u001b[39m         expect\u001b[33m.\u001b[39mobjectContaining({ error\u001b[33m:\u001b[39m \u001b[32m'Unauthorized'\u001b[39m })\u001b[33m,\u001b[39m\n     \u001b[90m 43 |\u001b[39m         expect\u001b[33m.\u001b[39mobjectContaining({ status\u001b[33m:\u001b[39m \u001b[35m401\u001b[39m })\n     \u001b[90m 44 |\u001b[39m       )\u001b[33m;\u001b[39m\u001b[0m\n\n      at Object.toHaveBeenCalledWith (tests/unit/middleware/mytest.test.ts:41:36)\n\n  ● Authentication Middleware › withAuthentication › should reject requests with invalid token format\n\n    expect(jest.fn()).toHaveBeenCalledWith(...expected)\n\n    Expected: ObjectContaining {\"error\": \"Unauthorized\"}, ObjectContaining {\"status\": 401}\n    Received: {\"success\": true}\n\n    Number of calls: 1\n\n    \u001b[0m \u001b[90m 58 |\u001b[39m       \u001b[36mawait\u001b[39m withAuthentication(req\u001b[33m,\u001b[39m handler)\u001b[33m;\u001b[39m\n     \u001b[90m 59 |\u001b[39m\n    \u001b[31m\u001b[1m>\u001b[22m\u001b[39m\u001b[90m 60 |\u001b[39m       expect(mockNextResponseJson)\u001b[33m.\u001b[39mtoHaveBeenCalledWith(\n     \u001b[90m    |\u001b[39m                                    \u001b[31m\u001b[1m^\u001b[22m\u001b[39m\n     \u001b[90m 61 |\u001b[39m         expect\u001b[33m.\u001b[39mobjectContaining({ error\u001b[33m:\u001b[39m \u001b[32m'Unauthorized'\u001b[39m })\u001b[33m,\u001b[39m\n     \u001b[90m 62 |\u001b[39m         expect\u001b[33m.\u001b[39mobjectContaining({ status\u001b[33m:\u001b[39m \u001b[35m401\u001b[39m })\n     \u001b[90m 63 |\u001b[39m       )\u001b[33m;\u001b[39m\u001b[0m\n\n      at Object.toHaveBeenCalledWith (tests/unit/middleware/mytest.test.ts:60:36)\n\n  ● Authentication Middleware › withAuthentication › should reject requests with invalid token\n\n    expect(jest.fn()).toHaveBeenCalled()\n\n    Expected number of calls: >= 1\n    Received number of calls:    0\n\n    \u001b[0m \u001b[90m 77 |\u001b[39m       \u001b[36mawait\u001b[39m withAuthentication(req\u001b[33m,\u001b[39m handler)\u001b[33m;\u001b[39m\n     \u001b[90m 78 |\u001b[39m\n    \u001b[31m\u001b[1m>\u001b[22m\u001b[39m\u001b[90m 79 |\u001b[39m       expect(verify)\u001b[33m.\u001b[39mtoHaveBeenCalled()\u001b[33m;\u001b[39m\n     \u001b[90m    |\u001b[39m                      \u001b[31m\u001b[1m^\u001b[22m\u001b[39m\n     \u001b[90m 80 |\u001b[39m       expect(mockNextResponseJson)\u001b[33m.\u001b[39mtoHaveBeenCalledWith(\n     \u001b[90m 81 |\u001b[39m         expect\u001b[33m.\u001b[39mobjectContaining({ error\u001b[33m:\u001b[39m \u001b[32m'Invalid token'\u001b[39m })\u001b[33m,\u001b[39m\n     \u001b[90m 82 |\u001b[39m         expect\u001b[33m.\u001b[39mobjectContaining({ status\u001b[33m:\u001b[39m \u001b[35m401\u001b[39m })\u001b[0m\n\n      at Object.toHaveBeenCalled (tests/unit/middleware/mytest.test.ts:79:22)\n\n  ● Authentication Middleware › withAuthentication › should allow requests with valid token\n\n    expect(jest.fn()).toHaveBeenCalled()\n\n    Expected number of calls: >= 1\n    Received number of calls:    0\n\n    \u001b[0m \u001b[90m  97 |\u001b[39m       \u001b[36mconst\u001b[39m result \u001b[33m=\u001b[39m \u001b[36mawait\u001b[39m withAuthentication(req\u001b[33m,\u001b[39m handler)\u001b[33m;\u001b[39m\n     \u001b[90m  98 |\u001b[39m\n    \u001b[31m\u001b[1m>\u001b[22m\u001b[39m\u001b[90m  99 |\u001b[39m       expect(verify)\u001b[33m.\u001b[39mtoHaveBeenCalled()\u001b[33m;\u001b[39m\n     \u001b[90m     |\u001b[39m                      \u001b[31m\u001b[1m^\u001b[22m\u001b[39m\n     \u001b[90m 100 |\u001b[39m       expect(handler)\u001b[33m.\u001b[39mtoHaveBeenCalledWith(req\u001b[33m,\u001b[39m \u001b[33mDEFAULT_USER_ID\u001b[39m)\u001b[33m;\u001b[39m\n     \u001b[90m 101 |\u001b[39m       \n     \u001b[90m 102 |\u001b[39m       \u001b[90m// Check that the result is the mockResponse\u001b[39m\u001b[0m\n\n      at Object.toHaveBeenCalled (tests/unit/middleware/mytest.test.ts:99:22)\n\n  ● Authentication Middleware › withAuthentication › should handle unexpected errors in the handler\n\n    expect(jest.fn()).toHaveBeenCalled()\n\n    Expected number of calls: >= 1\n    Received number of calls:    0\n\n    \u001b[0m \u001b[90m 121 |\u001b[39m       \u001b[36mawait\u001b[39m withAuthentication(req\u001b[33m,\u001b[39m handler)\u001b[33m;\u001b[39m\n     \u001b[90m 122 |\u001b[39m\n    \u001b[31m\u001b[1m>\u001b[22m\u001b[39m\u001b[90m 123 |\u001b[39m       expect(verify)\u001b[33m.\u001b[39mtoHaveBeenCalled()\u001b[33m;\u001b[39m\n     \u001b[90m     |\u001b[39m                      \u001b[31m\u001b[1m^\u001b[22m\u001b[39m\n     \u001b[90m 124 |\u001b[39m       expect(handler)\u001b[33m.\u001b[39mtoHaveBeenCalledWith(req\u001b[33m,\u001b[39m \u001b[33mDEFAULT_USER_ID\u001b[39m)\u001b[33m;\u001b[39m\n     \u001b[90m 125 |\u001b[39m       expect(mockNextResponseJson)\u001b[33m.\u001b[39mtoHaveBeenCalledWith(\n     \u001b[90m 126 |\u001b[39m         expect\u001b[33m.\u001b[39mobjectContaining({ error\u001b[33m:\u001b[39m \u001b[32m'Authentication failed'\u001b[39m })\u001b[33m,\u001b[39m\u001b[0m\n\n      at Object.toHaveBeenCalled (tests/unit/middleware/mytest.test.ts:123:22)\n","name":"C:\\Users\\T\\directorymonster\\tests\\unit\\middleware\\mytest.test.ts","startTime":1743455425450,"status":"failed","summary":""}],"wasInterrupted":false}
